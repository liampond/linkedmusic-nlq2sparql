PREFIX diamm: <https://linkedmusic.ca/graphs/diamm/>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

SELECT ?archive ?archiveLabel (COUNT(?source) AS ?sourceCount)
WHERE {
  GRAPH <https://linkedmusic.ca/graphs/diamm/> {
    # Find entities explicitly typed as DIAMM Archives
    ?archive rdf:type diamm:Archive .
    
    # Retrieve the label for the archive
    ?archive rdfs:label ?archiveLabel .
    
    # Find Sources that are located in (P276) these archives
    # We explicitly verify the type of the source as per instructions
    ?source rdf:type diamm:Source .
    ?source wdt:P276 ?archive .
  }
}
GROUP BY ?archive ?archiveLabel
ORDER BY DESC(?sourceCount)