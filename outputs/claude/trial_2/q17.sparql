PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX wdt: <http://www.wikidata.org/prop/direct/>
PREFIX wd: <http://www.wikidata.org/entity/>
PREFIX dtl: <https://linkedmusic.ca/graphs/dig-that-lick/>
PREFIX mb: <https://linkedmusic.ca/graphs/musicbrainz/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>

SELECT DISTINCT ?mbWork ?mbWorkLabel ?dtlTrack ?dtlTrackLabel
WHERE {
  # Find solos in Dig That Lick performed by Charlie Parker (Q103767)
  GRAPH <https://linkedmusic.ca/graphs/dig-that-lick/> {
    ?solo rdf:type dtl:Solo .
    ?solo wdt:P175 wd:Q103767 .
    ?solo wdt:P361 ?dtlTrack .
    ?dtlTrack rdf:type dtl:Track .
    OPTIONAL { ?dtlTrack rdfs:label ?dtlTrackLabel . }
    # Get the exact match (reconciled entity) for the track
    ?dtlTrack wdt:P2888 ?reconciledEntity .
  }
  
  # Find MusicBrainz works that match the same reconciled entity
  GRAPH <https://linkedmusic.ca/graphs/musicbrainz/> {
    ?mbWork rdf:type mb:Work .
    ?mbWork wdt:P2888 ?reconciledEntity .
    OPTIONAL { ?mbWork rdfs:label ?mbWorkLabel . }
  }
}